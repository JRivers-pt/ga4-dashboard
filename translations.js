/**
 * GA4 Dashboard - Translations
 * Supports: English (en), Portuguese (pt)
 */
const TRANSLATIONS = {
    en: {
        // Header
        title: 'GA4 Analytics',
        today: 'Today',
        last7days: 'Last 7 Days',
        last30days: 'Last 30 Days',
        last90days: 'Last 90 Days',
        demoMode: 'Demo Mode',
        connected: 'Connected',
        connectGA4: 'Connect GA4',

        // Performance Score
        performanceScore: 'Performance Score',
        score: 'Score',
        connectToSeeScore: 'Connect to GA4 to see your score',
        excellentPerformance: 'Excellent! Your site is performing great.',
        goodPerformance: 'Good performance with room for improvement.',
        averagePerformance: 'Average performance. Consider the recommendations below.',
        needsImprovement: 'Needs improvement. Check the insights for suggestions.',

        // Score Factors
        userGrowthUp: 'User Growth â†‘',
        userGrowthPlus: 'User Growth +',
        usersStable: 'Users Stable',
        usersDeclining: 'Users Declining',
        lowBounceRate: 'Low Bounce Rate',
        okBounceRate: 'OK Bounce Rate',
        highBounceRate: 'High Bounce Rate',
        veryHighBounce: 'Very High Bounce',
        highEngagement: 'High Engagement',
        okEngagement: 'OK Engagement',
        lowEngagement: 'Low Engagement',
        poorEngagement: 'Poor Engagement',
        longSessions: 'Long Sessions',
        okSessions: 'OK Sessions',
        shortSessions: 'Short Sessions',
        veryShortSessions: 'Very Short Sessions',

        // Quick Actions
        emailReports: 'Email Reports',
        refreshData: 'Refresh Data',

        // Metrics
        totalUsers: 'Total Users',
        sessions: 'Sessions',
        pageViews: 'Page Views',
        bounceRate: 'Bounce Rate',
        avgDuration: 'Avg. Duration',
        engagementRate: 'Engagement Rate',

        // Insights
        insightsTitle: 'ðŸ’¡ Insights & Recommendations',
        aiPowered: 'AI-Powered',
        connectToGA4: 'Connect to GA4',
        connectMessage: 'Connect your Google Analytics account to receive personalized insights and recommendations.',

        // Insight Messages
        trafficGrowing: 'Traffic is Growing!',
        trafficGrowingText: 'Your traffic increased by {0}%. Keep doing what you\'re doing and consider boosting successful campaigns.',
        trafficDeclining: 'Traffic is Declining',
        trafficDecliningText: 'Consider investing in SEO, Google Ads, or social media marketing to attract more visitors.',
        highBounceRateTitle: 'High Bounce Rate',
        highBounceRateText: '{0}% of visitors leave without interacting. Improve your landing page content, speed, and calls-to-action.',
        greatRetention: 'Great User Retention',
        greatRetentionText: 'Visitors are engaging well with your content. Consider adding more conversion opportunities.',
        lowEngagementTitle: 'Low Engagement',
        lowEngagementText: 'Add interactive elements, videos, or compelling CTAs to increase user engagement on your pages.',
        lowPagesPerSession: 'Low Pages per Session',
        lowPagesPerSessionText: 'Users view fewer than 2 pages. Improve internal linking and add related content suggestions.',
        leadGenTip: 'Lead Generation Tip',
        leadGenTipText: 'Add a newsletter signup, contact form, or free resource download to convert visitors into leads.',
        lookingGood: 'Looking Good!',
        lookingGoodText: 'Your site metrics are healthy. Focus on maintaining current performance and testing new optimizations.',

        // Charts
        usersOverTime: 'Users Over Time',
        trafficSources: 'Traffic Sources',
        topPages: 'Top Pages',
        byViews: 'By Views',
        deviceBreakdown: 'Device Breakdown',
        browsers: 'Browsers',
        topCountries: 'Top Countries',
        byUsers: 'By Users',
        newVsReturning: 'New vs Returning',

        // Table Headers
        pageTitle: 'Page Title',
        views: 'Views',
        users: 'Users',
        avgTime: 'Avg. Time',

        // Email Modal
        emailModalTitle: 'ðŸ“§ Weekly Report Settings',
        emailModalDesc: 'Receive a weekly summary of your analytics with insights and recommendations.',
        emailAddress: 'Email Address',
        frequency: 'Frequency',
        weekly: 'Weekly (Every Monday)',
        biweekly: 'Bi-weekly',
        monthly: 'Monthly',
        emailNote: 'Email reports require EmailJS setup.',
        signUpFree: 'Sign up free â†’',
        sendTestEmail: 'Send Test Email',
        saveSettings: 'Save Settings',

        // Misc
        loading: 'Loading analytics data...',
        dataRefreshed: 'Data refreshed!',
        noData: 'No data',
        noDataPeriod: 'No data for this period'
    },

    pt: {
        // Header
        title: 'GA4 Analytics',
        today: 'Hoje',
        last7days: 'Ãšltimos 7 Dias',
        last30days: 'Ãšltimos 30 Dias',
        last90days: 'Ãšltimos 90 Dias',
        demoMode: 'Modo Demo',
        connected: 'Conectado',
        connectGA4: 'Conectar GA4',

        // Performance Score
        performanceScore: 'PontuaÃ§Ã£o de Desempenho',
        score: 'Pontos',
        connectToSeeScore: 'Conecta ao GA4 para ver a tua pontuaÃ§Ã£o',
        excellentPerformance: 'Excelente! O teu site estÃ¡ a funcionar muito bem.',
        goodPerformance: 'Bom desempenho com margem para melhoria.',
        averagePerformance: 'Desempenho mÃ©dio. Considera as recomendaÃ§Ãµes abaixo.',
        needsImprovement: 'Precisa de melhoria. Verifica as sugestÃµes.',

        // Score Factors
        userGrowthUp: 'Crescimento â†‘',
        userGrowthPlus: 'Crescimento +',
        usersStable: 'Utilizadores EstÃ¡veis',
        usersDeclining: 'Utilizadores em Queda',
        lowBounceRate: 'Baixa Taxa de RejeiÃ§Ã£o',
        okBounceRate: 'Taxa de RejeiÃ§Ã£o OK',
        highBounceRate: 'Alta Taxa de RejeiÃ§Ã£o',
        veryHighBounce: 'RejeiÃ§Ã£o Muito Alta',
        highEngagement: 'Alto Engagement',
        okEngagement: 'Engagement OK',
        lowEngagement: 'Baixo Engagement',
        poorEngagement: 'Engagement Fraco',
        longSessions: 'SessÃµes Longas',
        okSessions: 'SessÃµes OK',
        shortSessions: 'SessÃµes Curtas',
        veryShortSessions: 'SessÃµes Muito Curtas',

        // Quick Actions
        emailReports: 'RelatÃ³rios Email',
        refreshData: 'Atualizar Dados',

        // Metrics
        totalUsers: 'Total Utilizadores',
        sessions: 'SessÃµes',
        pageViews: 'VisualizaÃ§Ãµes',
        bounceRate: 'Taxa de RejeiÃ§Ã£o',
        avgDuration: 'DuraÃ§Ã£o MÃ©dia',
        engagementRate: 'Taxa de Engagement',

        // Insights
        insightsTitle: 'ðŸ’¡ Insights e RecomendaÃ§Ãµes',
        aiPowered: 'IA',
        connectToGA4: 'Conectar ao GA4',
        connectMessage: 'Conecta a tua conta Google Analytics para receber insights e recomendaÃ§Ãµes personalizadas.',

        // Insight Messages
        trafficGrowing: 'O TrÃ¡fego EstÃ¡ a Crescer!',
        trafficGrowingText: 'O teu trÃ¡fego aumentou {0}%. Continua assim e considera impulsionar campanhas de sucesso.',
        trafficDeclining: 'O TrÃ¡fego EstÃ¡ a Diminuir',
        trafficDecliningText: 'Considera investir em SEO, Google Ads ou marketing nas redes sociais.',
        highBounceRateTitle: 'Taxa de RejeiÃ§Ã£o Alta',
        highBounceRateText: '{0}% dos visitantes saem sem interagir. Melhora o conteÃºdo da landing page e os CTAs.',
        greatRetention: 'Ã“tima RetenÃ§Ã£o de Utilizadores',
        greatRetentionText: 'Os visitantes estÃ£o a interagir bem. Considera adicionar mais oportunidades de conversÃ£o.',
        lowEngagementTitle: 'Baixo Engagement',
        lowEngagementText: 'Adiciona elementos interativos, vÃ­deos ou CTAs para aumentar o engagement.',
        lowPagesPerSession: 'Poucas PÃ¡ginas por SessÃ£o',
        lowPagesPerSessionText: 'Os utilizadores veem menos de 2 pÃ¡ginas. Melhora a ligaÃ§Ã£o interna entre pÃ¡ginas.',
        leadGenTip: 'Dica de GeraÃ§Ã£o de Leads',
        leadGenTipText: 'Adiciona newsletter, formulÃ¡rio de contacto ou download gratuito para converter visitantes em leads.',
        lookingGood: 'EstÃ¡ Tudo Bem!',
        lookingGoodText: 'As mÃ©tricas do site estÃ£o saudÃ¡veis. MantÃ©m o desempenho atual e testa novas otimizaÃ§Ãµes.',

        // Charts
        usersOverTime: 'Utilizadores ao Longo do Tempo',
        trafficSources: 'Fontes de TrÃ¡fego',
        topPages: 'PÃ¡ginas Principais',
        byViews: 'Por VisualizaÃ§Ãµes',
        deviceBreakdown: 'Dispositivos',
        browsers: 'Navegadores',
        topCountries: 'PaÃ­ses Principais',
        byUsers: 'Por Utilizadores',
        newVsReturning: 'Novos vs Regressados',

        // Table Headers
        pageTitle: 'TÃ­tulo da PÃ¡gina',
        views: 'VisualizaÃ§Ãµes',
        users: 'Utilizadores',
        avgTime: 'Tempo MÃ©dio',

        // Email Modal
        emailModalTitle: 'ðŸ“§ ConfiguraÃ§Ã£o de RelatÃ³rios',
        emailModalDesc: 'Recebe um resumo semanal das tuas analytics com insights e recomendaÃ§Ãµes.',
        emailAddress: 'EndereÃ§o de Email',
        frequency: 'FrequÃªncia',
        weekly: 'Semanal (Todas as Segundas)',
        biweekly: 'Quinzenal',
        monthly: 'Mensal',
        emailNote: 'RelatÃ³rios por email requerem configuraÃ§Ã£o do EmailJS.',
        signUpFree: 'Regista-te grÃ¡tis â†’',
        sendTestEmail: 'Enviar Email Teste',
        saveSettings: 'Guardar DefiniÃ§Ãµes',

        // Misc
        loading: 'A carregar dados...',
        dataRefreshed: 'Dados atualizados!',
        noData: 'Sem dados',
        noDataPeriod: 'Sem dados para este perÃ­odo'
    }
};

// Current language - default to Portuguese
let currentLang = localStorage.getItem('dashboardLang') || 'pt';

// Get translation
function t(key) {
    return TRANSLATIONS[currentLang][key] || TRANSLATIONS['en'][key] || key;
}

// Switch language
function switchLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('dashboardLang', lang);
    updateUILanguage();
}

// Update all UI elements with translations
function updateUILanguage() {
    // Update date buttons
    document.querySelectorAll('.date-btn').forEach(btn => {
        const range = btn.dataset.range;
        if (range === 'today') btn.textContent = t('today');
        if (range === '7days') btn.textContent = t('last7days');
        if (range === '30days') btn.textContent = t('last30days');
        if (range === '90days') btn.textContent = t('last90days');
    });

    // Update connection status
    const statusText = document.querySelector('.status-text');
    if (statusText) {
        const isConnected = document.getElementById('connection-status').classList.contains('connected');
        statusText.textContent = isConnected ? t('connected') : t('demoMode');
    }

    // Update auth button
    const authBtnText = document.querySelector('#auth-btn span');
    if (authBtnText) {
        const isConnected = document.getElementById('connection-status').classList.contains('connected');
        authBtnText.textContent = isConnected ? t('connected') : t('connectGA4');
    }

    // Update metric labels
    const metricLabels = document.querySelectorAll('.metric-label');
    const labelMap = ['totalUsers', 'sessions', 'pageViews', 'bounceRate', 'avgDuration', 'engagementRate'];
    metricLabels.forEach((label, i) => {
        if (labelMap[i]) label.textContent = t(labelMap[i]);
    });

    // Update score section
    const scoreLabel = document.querySelector('.score-label');
    if (scoreLabel) scoreLabel.textContent = t('score');

    const scoreDetailsH3 = document.querySelector('.score-details h3');
    if (scoreDetailsH3) scoreDetailsH3.textContent = t('performanceScore');

    // Update action buttons
    const emailBtnText = document.querySelector('#email-settings-btn span');
    if (emailBtnText) emailBtnText.textContent = t('emailReports');

    const refreshBtnText = document.querySelector('#refresh-btn span');
    if (refreshBtnText) refreshBtnText.textContent = t('refreshData');

    // Update insights section
    const insightsHeader = document.querySelector('.insights-section .section-header h2');
    if (insightsHeader) insightsHeader.textContent = t('insightsTitle');

    const aiBadge = document.querySelector('.insights-section .badge');
    if (aiBadge) aiBadge.textContent = t('aiPowered');

    // Update chart headers
    const chartHeaders = [
        { selector: '.charts-row .chart-card.large h3', key: 'usersOverTime' },
        { selector: '.charts-row .chart-card:not(.large) h3', key: 'trafficSources' },
        { selector: '.tables-row .table-card:first-child h3', key: 'topPages' },
        { selector: '.tables-row .table-card:last-child h3', key: 'deviceBreakdown' }
    ];

    // Update table headers
    const tableHeaders = document.querySelectorAll('#pages-table th');
    const headerKeys = ['pageTitle', 'views', 'users', 'avgTime'];
    tableHeaders.forEach((th, i) => {
        if (headerKeys[i]) th.textContent = t(headerKeys[i]);
    });

    // Update bottom row card headers
    const bottomHeaders = document.querySelectorAll('.bottom-row .card-header h3');
    const bottomKeys = ['browsers', 'topCountries', 'newVsReturning'];
    bottomHeaders.forEach((h3, i) => {
        if (bottomKeys[i]) h3.textContent = t(bottomKeys[i]);
    });

    // Update badges
    const byViewsBadge = document.querySelector('.tables-row .badge');
    if (byViewsBadge) byViewsBadge.textContent = t('byViews');

    const byUsersBadge = document.querySelector('.bottom-row .geography .badge');
    if (byUsersBadge) byUsersBadge.textContent = t('byUsers');

    // Update email modal
    const modalTitle = document.querySelector('.modal-header h3');
    if (modalTitle) modalTitle.textContent = t('emailModalTitle');

    const modalDesc = document.querySelector('.modal-body > p');
    if (modalDesc) modalDesc.textContent = t('emailModalDesc');

    // Update loading text
    const loadingText = document.querySelector('.loading-overlay span');
    if (loadingText) loadingText.textContent = t('loading');

    // Update language toggle button
    const langToggle = document.getElementById('lang-toggle');
    if (langToggle) {
        langToggle.textContent = currentLang === 'pt' ? 'ðŸ‡¬ðŸ‡§ EN' : 'ðŸ‡µðŸ‡¹ PT';
    }
}
